// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model User {
    id                              String        @id @default(uuid()) @db.Char(36)
    first_name                      String?
    last_name                       String?
    user_name                       String        @unique
    email                           String        @unique
    address                         Json?
    age                             Int?
    bio                             String?
    picture                         String?
    pronounce                       String?
    years_of_exprience              Int?
    profession                      String?
    lastLogin_ip                    String?
    password                        String
    password_reset_token            String?
    password_reset_token_expiration DateTime?
    created_at                      DateTime      @default(now())
    updated_at                      DateTime      @updatedAt
    OAuthToken                      OAuthToken?
    EmailLog                        EmailLog?
    sessions                        Session?
    Otp                             Otp?
    recoveryData                    RecoveryData?
    verified_email                  Boolean?

    @@index([user_name, email], map: "_IDX_UESR")
}

model RecoveryData {
    id      String @id @default(uuid()) @db.Char(36)
    user_id String @unique @db.Char(36)
    email   String
    number  String
    User    User   @relation(fields: [user_id], references: [id])
}

model OAuthToken {
    id            String   @id @default(uuid()) @db.Char(36)
    user_id       String   @unique
    access_token  String
    refresh_token String
    expire_in     Int
    created_at    DateTime @default(now())
    updated_at    DateTime @updatedAt
    user          User?    @relation(fields: [user_id], references: [id])
}

model EmailLog {
    id              String   @id @default(uuid()) @db.Char(36)
    user_id         String   @unique
    recipient_email String
    subject         String?
    body            String?
    status          String
    created_at      DateTime @default(now())
    user            User     @relation(fields: [user_id], references: [id])
}

model Session {
    id        String   @id @default(uuid()) @db.Char(36)
    sid       String   @unique
    user_id    String?  @unique
    user      User?    @relation(fields: [user_id], references: [id])
    expires_at DateTime @db.Timestamp(6)
    data      Json     @db.Json

    @@index([expires_at], map: "IDX_session_expire")
}

model Otp {
    id         String   @id @default(uuid()) @db.Char(36)
    user_id     String   @unique
    otp        String
    created_at DateTime @default(now())
    expires_at  DateTime
    user       User?    @relation(fields: [user_id], references: [id])
}
